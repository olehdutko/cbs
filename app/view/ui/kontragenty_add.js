/*
 * File: app/view/ui/kontragenty_add.js
 * Date: Mon Sep 05 2011 19:04:54 GMT+0300 (FLE Daylight Time)
 *
 * This file was generated by Ext Designer version 1.2.0.
 * http://www.sencha.com/products/designer/
 *
 * This file will be auto-generated each and everytime you export.
 *
 * Do NOT hand edit this file.
 */
var str_Stan = 'Chyslytsia';
var str_Type = 'Postachalnik'

Ext.define('Borsuko.view.ui.kontragenty_add', {
    extend: 'Ext.form.Panel',

    autoRender: true,
    autoShow: true,
    frame: true,
    id: 'form',
    itemId: 'form',
    styleHtmlContent: true,
    autoScroll: true,
    maintainFlex: true,
    layout: {
        type: 'auto'
    },
    bodyPadding: 10,
    animCollapse: false,
    collapseFirst: false,
    collapsed: false,
    collapsible: true,
    frameHeader: false,
    title: 'Додавання контрагенту',
    titleCollapse: true,
    pollForChanges: true,
    paramsAsHash: true,
    standardSubmit: true,
    trackResetOnLoad: true,

    initComponent: function() {
        var me = this;
        me.items = [
            {
                xtype: 'fieldset',
                frame: true,
                padding: 10,
                width: 852,
                items: [
                    /*{
                        xtype: 'textfield',
                        id: 'nomer',
                        width: 350,
                        fieldLabel: 'Номер',
                        labelWidth: 150
                    },*/
                    {
                        xtype: 'textfield',
                        id: 'PIB',
                        width: 500,
                        fieldLabel: 'ПІБ (Назва)',
                        labelWidth: 150,
                        emptyText: 'Прізвище та Ім`я'
                    },
                    {
                        xtype: 'textfield',
                        id: 'telefon',
                        width: 500,
                        fieldLabel: 'Телефон',
                        labelWidth: 150,
                        emptyText: 'Телефон'
                    },
                    {
                        xtype: 'textareafield',
                        height: 85,
                        id: 'info',
                        width: 500,
                        name: 'info',
                        fieldLabel: 'Контактна Інформація',
                        labelWidth: 150,
                        emptyText: 'Контакти'
                    },
                    {
                        xtype: 'datefield',
						format : "d/m/Y",
                        id: 'date',
                        width: 500,
                        name: 'date',
                        fieldLabel: 'Дата',
						listeners: {
						render: function() {
							this.setValue(new Date());
						}
						},
                        labelWidth: 150
                    },
                    {
                                xtype: 'combobox',
								width: 500,
		                        labelWidth: 150,
								editable: false,
                                id: 'TypKontragentaCombo',
                                name: 'TypKontragentaCombo',
                                fieldLabel: 'Тип контрагентів',
                                displayField: 'type',
                                queryMode: 'local',
                                store: 'TypKontragenta_store',
                                valueField: 'type',
								 listeners: {
								select: {
									fn:function(combo, value) 
									{
									switch (combo.value)
									{
								
								case 'Працівники':
									str_Type = 'Pracivnyk'
									break;
								case 'Менеджери':
									str_Type = 'Manager'
									break;
								case 'Постачальники':
									str_Type = 'Postachalnik'
									break;
									};
									}
								}
							}
                            },
                    {
                        xtype: 'radiogroup',
                        id: 'Stan',
                        width: 780,
                        fieldLabel: 'Стан',
                        items: [
                            {
                                xtype: 'radiofield',
                                id: 'Chyslytsia',
                                name: 'Stan',
                                boxLabel: 'Числиться',
                                checked: true,
								handler: function() {
									switch (this.getValue())
										{
									case true: 
										str_Stan = 'Chyslytsia'
										break;
									case false: 
										str_Stan = 'Zvilneno'
										break;
										}
									}
                            },
                            {
                                xtype: 'radiofield',
                                id: 'Zvilneno',
                                name: 'Stan',
                                boxLabel: 'Звільнено',
								handler: function() {
									switch (this.getValue())
										{
									case false: 
										str_Stan = 'Chyslytsia'
										break;
									case true: 
										str_Stan = 'Zvilneno'
										break;
										}
									}
                            }
                        ]
                    },
                    {
                        xtype: 'textareafield',
                        height: 85,
                        id: 'prymitka',
                        width: 500,
                        fieldLabel: 'Примітка',
                        labelWidth: 150,
                        emptyText: 'Примітка'
                    }
                ]
            }
        ];
        me.dockedItems = [
            {
                xtype: 'toolbar',
                dock: 'top',
                items: [
                    {
                        xtype: 'button',
                        id: 'add',
                        text: 'Добавити Контрагента',
						iconCls: 'add16',
						handler : function(){
							AddKontrAgent()
						}
                    }
                ]
            }
        ];
        me.callParent(arguments);
    }
});


function AddKontrAgent(){	
		//var str_nomer = Ext.getCmp("nomer").getValue();
		var str_PIB = Ext.getCmp("PIB").getValue();
		var str_prymitka = Ext.getCmp("prymitka").getValue();
		var str_telefon = Ext.getCmp("telefon").getValue();
		var str_info = Ext.getCmp("info").getValue();
		var str_date = Ext.getCmp("date").getValue();

	Ext.Ajax.request(
	{
		url: './php/insert_kontragent.php',
		params: {
			//objnomer: str_nomer,
			PIB: str_PIB,
			prymitka: str_prymitka,
			telefon: str_telefon,
			info: str_info,
			date: str_date,
			Type: str_Type,
			Stan: str_Stan
		},
		success: function()
		{
			Ext.MessageBox.alert('Контрагент доданий!', 'Контрагент доданий');
			//window.location = "./kontragenty_view.php";
		},
		failure: function(response)
		{
			Ext.MessageBox.alert('Помилка', 'Неможливо доступитися до бази даних');
		}
	})
	}